---
title: "Erste Schritte mit **R Markdown**"
subtitle: "Reproduzierbare Analyse-Skripts schreiben und bereitstellen"
author: "JosÃ© C. GarcÃ­a Alanis"
date: "`r format(Sys.time(), '%d. %B, %Y')`"
# header-includes:
#    - \usepackage[default]{sourcesanspro}
#    - \usepackage[T1]{fontenc}
# mainfont: SourceSansPro
fontsize: 12pt
output: pdf_document
---

```{r echo = FALSE, eval = FALSE}
knitr::opts_chunk$set(echo = TRUE, dev="cairo_pdf")
```

# Inhalte dieser Ãœbung

- Was ist R-Markdown?
- Warum ist es eine gute Idee, R Markdown zu lernen?
- Wie kann ich eine R Markdown Datei erstellen?
- Wie kann ich eine R Markdown als PDF exportieren?

# Erste Schritte mit **R-Markdown**

## Was ist R Markdown?

**R Markdown** ist eine sehr zugÃ¤ngliche und einfache Methode, R-Skripte zu dokumentieren und reproduzierbar zu machen. HÃ¤ufig wird als â€groÃŸer Nachteilâ€œ von R-Skripten genannt, dass man keinen einfachen Text in einem R-Skript aufnehmen kann. Alles, was wir in einem R-Skript â€schreiben", muss in der R-Syntax geschrieben sein, sonst lÃ¤uft das Skript nicht. Text-ErklÃ¤rungen zum â€R-codeâ€œ kÃ¶nnen hÃ¶chstens als Kommentar eingefÃ¼gt werden (diese werden von einer Raute `#` vorangegangen).

R Markdown bietet eine einfache LÃ¶sung fÃ¼r dieses Problem an.

## Ist R-Markdown eine (weitere) Programmiersprache?

Nicht ganz. R-Markdown ist ein spezielles Dateiformat und eine Syntax fÃ¼r dieses Dateiformat. Diese Syntax macht das Benutzen von Markdown-Befehlen in R extrem einfach. Im Hintergrund lÃ¤uft **Markdown**, eine sehr einfache â€œMarkupâ€-Sprache (Ã¤hnlich wie `html`), die Befehle zur Erstellung von Dokumenten aus einer reinen Text-Datei bereitstellt. Wir kÃ¶nnen Markdown-Dokumente in viele andere Dateitypen wie `.html` oder `.pdf` umwandeln. Dabei kÃ¶nnen Ãœberschriften, Bilder automatisch generiert und anzuzeigen, wÃ¤hrend die ursprÃ¼ngliche R-Datei "unverÃ¤ndert" bleibt und in einer Art formatiert ist, dass sie leicht zu lesen ist. Zum Beispiel, die Datei, die Sie gerade lesen, haben wir mit R-Markdown erstellt. Das R-Buch, was Sie wÃ¤hrend des R-Tutoriums im ersten Teil des Semesters kennengelernt haben, haben mit R-Markdown erstellt.

Also keine Sorge, sie mÃ¼ssen die keine weitere â€œProgrammierspracheâ€ lernen.
Sie mÃ¼ssen Ihre R-Skripte â€œnurâ€ in einem anderen Dateiformat (als `.Rmd` Datei) abspeichern und einige wenige Formatierungsregeln einhalten.

## Warum R-Markdown?

R Markdown ermÃ¶glicht uns, R-Skripte unkompliziert zu dokumentieren.
R Markdown Dokumente kÃ¶nnen als eine Art "Analyse-Protokoll" fÃ¼r die von uns durchgefÃ¼hrten Analysen benutzt werden. Forschung ist nur dann wirklich reproduzierbar, wenn andere Forscher:innen leicht verstehen kÃ¶nnen, was wir in unseren Analysen getan haben. Ohne Analyse-Protokollen und Dokumentation kann niemand wirklich verstehen, warum und wie genau wir manche Analysen durchgefÃ¼hrt haben. Manchmal ist es auch fÃ¼r uns selbst nur teilweise nachvollziehbar, warum wir frÃ¼here Analysen so durchgefÃ¼hrt haben, wie wir sie durchgefÃ¼hrt haben. Es ist deswegen hilfreich, ein R Markdown-Dokument als Anhang zu einer Arbeit (z.B. Masterarbeit oder Projektarbeit) zu erstellen. Wir kÃ¶nnen dann das dieses Dokument auf ein Online-Repositorium (z.B. das Open-Science-Framework) hochladen, oder es einfach als persÃ¶nliche Aufzeichnung behalten. Wenn wir zu einem spÃ¤teren Zeitpunkt auf unseren Code blicken, kÃ¶nnen wir dann leicht nachvollziehen, was wir getan haben und warum wir das so getan haben.

Der Vorteil von R Markdown Dokumenten ist, dass sie sowohl Code (z.B. R-Code, was wir benutzt haben, um eine Grafik zu generieren) und das Resultat von eben diesem Code (z.B. die Grafik, die wir damals erstellt haben) enthalten. ZusÃ¤tzlich kÃ¶nnen wir Text-ErklÃ¤rungen einfÃ¼gen, und zwar so, wie wir das bei einem Word-Dokument machen wÃ¼rden. Einfach als (reiner) Text.

R Markdown Dokumente sind also ein bisschen wie ein Notizbuch. Dort stehen die Ziele unserer Analysen, gefolgt von den Schritten, die wir gefolgt sind, um diese Ziele zu erreichen, die Methoden, die wir angewendet haben und schlieÃŸlich die Ergebnisse, die wir mit diesen Analysen erzielen konnten.

## R Markdown herunterladen

Um sicherzugehen, dass `rmarkdown` bei Ihnen installiert ist, benutzen Sie den folgenden R-Befehl, um `rmarkdown` jetzt zu installieren.

```{r eval=FALSE}
install.packages("rmarkdown")
```

# Erstellen Sie eine R-Markdown-Datei (`.Rmd`)

#### Ãœbung 1

> Wenn wir eine R-Markdown-Datei (`.Rmd`) mit R-Studio erstellen mÃ¶chten, mÃ¼ssen wir dies Ã¼ber das Datei-Fenster tun.
> 
> 1. Ã–ffnen Sie R-Studio (falls Sie dies nicht ohnehin schon getan haben).
> 2. Gehen Sie nun oben links auf das â€œNeue Datei Symbolâ€ (ein weises Viereck mit einem grÃ¼n-weiÃŸen Plus-Zeichen).
> 3. Dann wÃ¤hlen Sie â€œR Markdownâ€¦â€
> - Alternativ kÃ¶nne sie das Ganze Ã¼ber das Datei-Fenster oben Links erledigen (Datei -> Neues Dokument -> R Markdownâ€¦)
> 
> Sie werden merken, dass R-Studio ein keines Dialog-Fenster Ã¶ffnet. Dort kÃ¶nnen Sie ein Name fÃ¼r das R Markdown Dokument  und andere Einstellungen festlegen.
> 
> 1. Geben Sie unter Titel **rmarkdown-101**
> 2. Geben Sie unter Autor ihr Name an
> 3. WÃ¤hlen Sie als Output-Format: **HTML**

FÃ¼r jetzt konzentrieren wir uns auf ein `.html`-Dokument, das spÃ¤ter leicht in andere Dateitypen umgewandelt werden kann.

R-Studio erstellt einen neue `.Rmd` Datei. Diese sollte automatisch aufgegangen sein. Die neu erstellte `.Rmd`-Datei enthÃ¤lt Beispiele und Code. Wir mÃ¶chten allerdings unser eigenes R Markdown-Skript erstellen. LÃ¶schen also erst ein mal, was in der neu erstellten `.Rmd`-Datei enthalten ist.

Wir erstellen jetzt in gewisser Hinsicht eine Master R Markdown Datei. Wenn Sie eigene R-Skripte haben, die Sie in ein R Markdown-Dokument umwandeln mÃ¶chten, kÃ¶nnen Sie diese Datei als Beispiel verwenden!

## Das `YAML`-Header

Am Anfang jedes R Markdown-Skripts steht ein sogenannter **YAML-Header**. Dieser wird durch **`---`** eingeschlossener (drei Bindestriche oben und unten). StandardmÃ¤ÃŸig enthÃ¤lt dieser einen Titel, Autor, Datum und den Dateityp. Der Dateityp ist das Format, in dem unser R Markdown Skript am Ende haben wollen. Es stehe uns viele verschiedenen Optionen fÃ¼r das YAML-Header stehen zur VerfÃ¼gung. Heute werden wir uns mit dem absoluten Minimum beschÃ¤ftigen.

Hier ist ein Beispiel fÃ¼r ein YAML-Header. Sie kÃ¶nnen dieses Beispiel auch fÃ¼r zukÃ¼nftige Dateien benutzen.

```{yml eval = FALSE}
---
title:  "EinfÃ¼hrung in Markdown"
author: JosÃ©
date:   7. Juni 2023
output: html_document
---
```

StandardmÃ¤ÃŸig werden der Titel, Autor, Datum und Ausgabeformat am Anfang Ihres .html-Dokuments gedruckt. Dies ist das Minimum, was Sie in Ihren Headerbereich einfÃ¼gen sollten.

#### Ãœbung 2

> Kopieren Sie den oberen `YAML-Header`, fÃ¼gen Sie diesen in der von Ihnen erstellten `.Rmd`-Datei ein und bearbeiten Sie ihn.
> Geben Sie Titel, Autor und Datum ein.
> Das Argment `output: html_document` kann so bleiben.

Jetzt, da wir unseren ersten Inhalt haben, kÃ¶nnen wir die `.Rmd`-Datei testen, indem wir sie zu `.html` kompilieren (auch "rendern" genannt). Um die `.Rmd`-Datei in ein `.html`-Dokument zu konvertieren, klicken wir auf den `Knit`-Knopf in der Taskleiste (dieses sieht so aus: ![](RStudio_knit_icon.png){width=20, height=20} **knit**). (`knit` *engl.* fÃ¼r Stricken)

R-Studio Ã¶ffnet dann ein separates Vorschaufenster, um die Ausgabe der `.Rmd`-Datei anzuzeigen. Wenn Sie mÃ¶chten, dass die Ausgabe im Viewer-Fenster in R-Studio angezeigt wird (demselben Fenster, in dem Sie Grafiken sehen wÃ¼rden), wÃ¤hlen Sie "Vorschau in IDE Fenster" aus dem Dropdown-MenÃ¼, das erscheint, wenn Sie auf Einstellungen-Zahnradsymbols neben dem knit-Button klinken.

## Markdown Syntax

Sie kÃ¶nnen ganz normal in dem R Markdown Dokument schreiben. Der Text wird dann beim `knitten` in die Output-Datei geschrieben. Des Weiteren kÃ¶nnen Sie Markdown-Syntax in Ihrem R Markdown Dokument verwenden. Sobald Sie Ihr Dokument zusammenfÃ¼gen, wird der Ausgabetext gemÃ¤ÃŸ den folgenden einfachen Regeln formatiert.

### Formatierungsregeln

Fettgedruckter Text kann folgendermaÃŸen geschierben werden: 

```{md}
**fettgedruckter Text**
```

Wenn etwas Text also durch `*`-Zeichen eingeschlossen wird, wird alles was sich innerhalb der `*`-Zeichen befindet **fett**
gedruckt.

Die obige Schreibweise gibt folgendes Resultat:

**fettgedruckter Text**

Ã„hnlich verhÃ¤lt es sich mit *kursiver Text*

```{md}
*kursiv*
```

wird zu:

*kursiv*

Wenn wir etwas als Code (z.B. R-Code) ausweisen wollen, kÃ¶nne wir den Text durch Grave-Akzente ( ` ) umschlieÃŸen, wie hier:


```{md}
`code`
```

wird in einem R Markdown Dokument zu:

`code`

(die Schrift hat sich etwas geÃ¤ndert).

Titeln und Subtiteln stellen eine weitere Besonderheit dar. Wir kÃ¶nnen die GrÃ¶ÃŸe der Titel-Schrift durch die Anzahl an `#`-Symbolen, die den Text vorangehen, kontrollieren.

Die folgende Schreibweise 

```{md}
# Titel

## Subtitel

### Sub-Subtitel
```

wird beim *knitten* werden zu:

# Titel

## Subtitel

### Sub-Subtitel

Bisher haben wir das `#`-Symbol in R-Skripten dafÃ¼r benutzt Kommentare einzufÃ¼gen. In einem R Markdown Dokument benutzen wir das `#`-Symbol im Text, um die GrÃ¶ÃŸe der Ãœberschriften zu steuern.

### Ãœbung 3

> Kopieren Sie nun den folgenden Text und fÃ¼gen Sie ihn in der von Ihnen erstellten R Markdown Datei. FÃ¼gen Sie den Text unterhalb von YAML-Header.
> **knitten** Sie anschliÃŸend das Dokument neu.

```{md}
# Erste Schritte mit R Markdown

Markdown ist **sehr einfach** ğŸ˜Š
```

Unter dem YAML-Header befindet sich also der Bereich, in dem wir schreiben kÃ¶nnen, was wir wollen. Text kann mit der obigen Syntax formatiert werden. 

## R-Code in R Markdown Dateien einfÃ¼gen

Ein Markdown Dokument kann ebenfalls R-Code enthalten, das beim **knitten** â€œausgefÃ¼hrtâ€ werden soll. Das heiÃŸt, dass R im Hintergrund die Operationen durchfÃ¼hren  wird, und dann im â€œgeknittetenâ€ Dokument das Resultat schreiben wird.
CodeblÃ¶cke in einem `.Rmd`-Dokument werden von drei rÃ¼ckwÃ¤rtsgewandten Apostrophen ``` (Grave-Akzenten!) eingeschlossen sein. Diese sind als CodeblÃ¶cke bekannt und sehen so aus:

````{md}
```{r, eval = FALSE}
norm <- rnorm(100, mean = 0, sd = 1)
plot(density(norm))
```
````

Innerhalb der geschweiften Klammern befindet sich ein Bereich, in dem Sie Regeln fÃ¼r diesen Codeblock festlegen kÃ¶nnen. Der oben gezeigte Codeblock besagt, dass der Code R-Code ist (wir werden spÃ¤ter auf einige andere Regeln fÃ¼r geschweifte Klammern eingehen).

### Ãœbung 4

> Kopieren Sie das obige Codeblock und fÃ¼gen Sie es in Ihrer `.Rmd`-Datei ein.
> **knitten** die Datei neu.

Sie kÃ¶nnen neue CodeblÃ¶cke auch mit dieser kleinen Button in R-Studio.

![](codeblock.png)

#### Ãœbung 5

##### Mehr CodeblÃ¶cke

Es ist wichtig zu bedenken, dass wenn wir eine R Markdown Datei erstellen, in der wir Code ausfÃ¼hren mÃ¶chten, der sich auf ein Objekt bezieht, zum Beispiel:

````{md}
```{r, eval = FALSE}
daten
```
````

mÃ¼ssen wir Anweisungen einfÃ¼gen, die R sagen, was das Objekt `daten` ist. Ã„hnlich wie wir das in einem normalen R-Skript tun wÃ¼rden. 

Zum Beispiel:

````{md}
```{r, eval = FALSE}
daten <- c(1, 2, 3, 4, 5)
```
````

Wenn wir versuchen uns `daten` Anzeigen zu lassen (wie in dem vorherigen R Codeblock), ohne `daten` vorher zu definieren, wird R Markdown die Erstellung des Dokuments stoppen und uns ein Fehler mitteilen.

#### Ãœbung 6

> Versuchen den obigen Codeblock in Ihrer `.Rmd`-Datei einzufÃ¼gen, ohne vorher `daten` zu definieren. **knitten** Sie das Dokument neu. Was passiert?
> Definieren Sie nun `daten` bevor Sie auf `daten` zugreifen und **knitten** Sie neu. Was passiert?

## Wrap-Up
